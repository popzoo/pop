<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta content="lvlanxing" name="author">
<title>æ–—é±¼è½¦é˜Ÿå±•</title>
<link rel="shortcut icon" href="https://rawcdn.githack.com/popzoo/pop/9d4121eed5cbb035e55203b8a9e56a73dcf2e6bf/images/favicon.ico"> 
<meta content="è½¦é˜Ÿ,æ–—é±¼è½¦é˜Ÿ,è½¦é˜Ÿå¤§å…¨,è½¦é˜Ÿé›†åˆ,Pinterestç€‘å¸ƒæµæ•ˆæœ" name="Keywords">
<link rel="stylesheet" href="css/pop_page.css">
<script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? "https://" : "http://");document.write(unescape("%3Cspan style='display:none;' id='cnzz_stat_icon_1278032070'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "v1.cnzz.com/z_stat.php%3Fid%3D1278032070%26show%3Dpic1' type='text/javascript'%3E%3C/script%3E"));</script>
</head>
<body>
     <a href="https://github.com/ownthink/robot/" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#64CEAA; color:#fff; position: fixed; top: 0; border: 0; left: 0; transform: scale(-1, 1);z-index: 10;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

    <a href="https://github.com/wolf-scream/FirePowerSeek" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#70B7FD; color:#fff; position: fixed; top: 0; border: 0; right: 0;z-index: 100;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>
    <style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style> 
<div style=" height:30px; color:#3C3C3C; line-height:30px; margin:20px 0 -30px 0; padding:0 0 0 0;text-align: center; font-size:30px; font-family: Arial,Microsoft YaHei,'å®‹ä½“';">
        <span class="collapse" style="float: left;white-space: nowrap; margin-left: 50px; font-size: 20px;color:#4D4D4D;">
        <dfn data-info="ç»†åŒ–æ–—é±¼åŠ å…¥è½¦é˜Ÿæœç´¢æ¡ä»¶ï¼Œç”±äºæ–—é±¼å®˜æ–¹è½¦é˜Ÿæœç´¢åç©·äººè®¾è®¡ç†å¿µï¼Œä»¥è‡³äºå¤§å®¶æ‰¾ä¸ªé—¨æ§›ä½çš„è½¦é˜Ÿè¦ç‚¹ä¸ªå‡ ç™¾æ¬¡æ‰æ‰¾åˆ°ï¼Œåªå¥½è‡ªå·±åŠ¨æ‰‹ä¸°è¡£è¶³é£Ÿï¼Œå¤§å®¶è¿›è½¦é˜Ÿå¯é¢†æ¯æ—¥åŠ æ²¹å¡ã€å‘¨è½¬ä¸¸å­æˆ–æŠ¢çº¢åŒ…ï¼ˆæ³¨ï¼šç°åœ¨æŠ¢ä¸¸å­æœºå™¨äººå¤ªå¤šï¼Œå‘¨è½¬å…ˆè¯•æ°´å“¦ï¼‰ã€‚ç”±äºæ²¡æœåŠ¡å™¨çˆ¬æ•°æ®ï¼Œåšä¸»ä¸å®šæ—¶æ‰‹åŠ¨æ›´æ–°æ•°æ®ï¼Œå¤§å®¶å¯ä»¥ç‚¹å‡»å›¾ç‰‡è¿›æ–—é±¼æŸ¥çœ‹å…¥é˜Ÿå®¡æ‰¹æ˜¯å¦ä¸€è‡´ï¼">
        åŠ å…¥æ¡ä»¶:
        <label for="no_limit" class="radio">
            <span class="radio-bg"></span>
            <input type="radio" name="radio_fire" id="no_limit"  value="no_limit" />ä¸é™
            <span class="radio-on"></span>
        </label>
        <label for="level_limit" class="radio">
            <span class="radio-bg"></span>
            <input type="radio" name="radio_fire" id="level_limit"  value="level_limit" />ç­‰çº§
            <span class="radio-on"></span>
        </label>
        <label for="noble_limit" class="radio">
            <span class="radio-bg"></span>
            <input type="radio" name="radio_fire" id="noble_limit"  value="noble_limit" />è´µæ—
            <span class="radio-on"></span>
        </label>
        <label for="fans_limit" class="radio">
            <span class="radio-bg"></span>
            <input type="radio" name="radio_fire" id="fans_limit"  value="fans_limit" />ç²‰ä¸
            <span class="radio-on"></span>
        </label>
        </dfn>
        </span>
    <span style="margin-left: 20px;">ğŸ¡æ–—é±¼è½¦é˜Ÿç­›é€‰ğŸ¡</span>
    <span class="collapse" style="float: right;white-space: nowrap; margin-right: 60px; font-size: 20px;color:#4D4D4D;"> 
      <a class="nav-link" style="text-decoration:none;" href="https://popzoo.github.io/zoo/">æ—¶å…‰è½´</a> â€¢
        <a class="nav-link" style="text-decoration:none;" href="https://popzoo.github.io/barrage/">äº‘å¼¹å¹•</a> â€¢
        <a class="nav-link" style="text-decoration:none;" href="https://popzoo.github.io/pop/giftshow.html">ç¤¼ç‰©ç§€</a> â€¢
        <a class="nav-link" style="text-decoration:none;" href="https://popzoo.github.io/pop/motorcade.html">è½¦é˜Ÿå±•</a> â€¢
        <a class="nav-link" style="text-decoration:none;" href="https://greasyfork.org/zh-CN/scripts/389379">GreaseFork</a>
    </span>
</div>
<div class="content">
  <div id="device" class="gridalicious">
    <div class="galcolumn">
<!--    <div class="item"><img src="images/1.jpg" alt="å“åº”å¼ç€‘å¸ƒæµå¸ƒå±€æ’ä»¶"/><p>JSä»£ç ç½‘</p></div>  -->
    </div>
  </div>
</div>
<div id="rocket-to-top">
  <div style="opacity: 0; display: block;" class="level-2"></div>
  <div class="level-3"></div>
</div>
    <!-- loadingæŒ‰é’®è‡ªå·±é€šè¿‡æ ·å¼è°ƒæ•´ -->
<footer id="loading">
    åŠ è½½ä¸­...
</footer>
<!-- <script src="js/jquery-1.8.3.min.js"></script> -->
<script src="https://libs.baidu.com/jquery/1.8.3/jquery.min.js"></script>
<script src="js/jquery.grid-a-licious.min.js"></script>
<script src="js/spider-background.js"></script> 
<script src="js/rocket.js"></script>
<script type="text/javascript">
    var count = 0;
    var fleetList = new Array();
    //======================================================
    //=================== Script init ======================
    //======================================================
    window.onload = function initProgram(){
        let radioObj = sessionStorage.getItem("motorcadeStatus")!=null ? sessionStorage.getItem("motorcadeStatus") : "no_limit";
        let radioNode = document.getElementById(radioObj);
        radioNode.setAttribute("checked","checked");
        radioEventListener();
        var urlTail = "fleet_type_1.json";//default
        if(radioObj == "level_limit"){
            urlTail = "fleet_type_2.json";
        }else if(radioObj == "noble_limit"){
            urlTail = "fleet_type_3.json";
        }else if(radioObj == "fans_limit"){
            urlTail = "fleet_type_5.json";
        }
        // no use cdn for cache, just use its reflected within minutes, but master change will take effected in 24 hours
        // urlTail +="?env=dev";
        // get origin data, last term should change use fast and reliable way to get data 
        if(navigator.language == "zh-CN"){//according to primary language
            getMotorcadeDataDomestic(urlTail);
        }else{
            getMotorcadeDataAbroad(urlTail);
        }
    }    
    // add Event Listener of radio onchange
    function radioEventListener(){
        var radioObj = document.getElementById("no_limit");
        if(radioObj!=undefined){
            var anchor1 = radioObj;
            anchor1.addEventListener("change",(function(){radioFunc('no_limit');}));
            var anchor2 = document.getElementById("level_limit");
            anchor2.addEventListener("change",(function(){radioFunc('level_limit');}));
            var anchor3 = document.getElementById("noble_limit");
            anchor3.addEventListener("change",(function(){radioFunc('noble_limit');}));
            var anchor4 = document.getElementById("fans_limit");
            anchor4.addEventListener("change",(function(){radioFunc('fans_limit');}));
        }else{
            console.error("æ— æ³•è·å–radioå…ƒç´ ");
        }
    }
    // listenning radio onchange event
    function radioFunc(msg){
        if(msg == "no_limit"){
            sessionStorage.setItem("motorcadeStatus",msg);
            location.reload();
        }else if(msg =="level_limit"){
            sessionStorage.setItem("motorcadeStatus",msg);
            location.reload();
        }else if(msg =="noble_limit"){
            sessionStorage.setItem("motorcadeStatus",msg);
            location.reload();
        }else if(msg =="fans_limit"){
            sessionStorage.setItem("motorcadeStatus",msg);
            location.reload();
        }
    }
    // get data from abroad statically cdn
    function getMotorcadeDataAbroad(urlTail){
        // fetch('https://raw.githubusercontent.com/popzoo/gift-show/master/json/'+urlTail,{
        fetch('https://cdn.statically.io/gh/popzoo/pop/master/json/'+urlTail,{
            method: 'GET',
            mode: 'cors', 
            cache: 'default', 
            credentials: 'omit', 
        }).then(res => {
            return res.text();
        }).then(result => {
            fleetList = JSON.parse(result.substring(17, result.length-2));
            console.info("å½“å‰é¡µé¢è½¦é˜Ÿæ€»æ•°ï¼š"+fleetList.length);
            $("#device").gridalicious('append', makeboxes());
        }).catch(err => {
            getMotorcadeDataDomestic(urlTail);
            console.error('è¯·æ±‚é”™è¯¯', err);
        })
    }
    // get data from domestic coding
    function getMotorcadeDataDomestic(urlTail){
        $.ajax({
            async : true,
            url : "https://coding.net/u/lvlanxing/p/popzoo/git/raw/master/json/"+urlTail,
            type : "GET",
            dataType : "jsonp", 
            jsonp : 'callback', 
            jsonpCallback: 'DYConfigCallback', 
            success: function(response, status, xhr){
                if(status == "success"){
                    fleetList=[].concat(response);
                    console.info("æ­¤é¡µé¢è½¦é˜Ÿæ€»æ•°:"+fleetList.length);
                    $("#device").gridalicious('append', makeboxes());
                }
            },
            error:function(xhr,status,error){
                console.info(status);
                getMotorcadeDataAbroad(urlTail);
            }
        });
    }

	//adding content with random way when scroll bar moved
    function makeboxes(){
        var boxes = new Array;
        if(count*50<fleetList.length){
            for(let i=count*50;i<Math.min((count+1)*50, fleetList.length);i++){
                // console.info(fleetList[i]); encodeURIComponent(fleetList[i].mcId)
                let div = $('<div></div>').addClass('item');
                var content = "<a href='https://msg.douyu.com/motorcade/#/motorcade/search?keyword="+fleetList[i].number+"' target='_blank'><img src='"+fleetList[i].icon+"'/></a>";
                content += "<p>è½¦å:<strong style='color:red;'>"+fleetList[i].name+"</strong>&nbsp;äººæ•°:<strong style='color:red;'>";
                content += fleetList[i].memberCount+"</strong>&nbsp;è½¦æ ‡:<strong style='color:red;'>"+fleetList[i].flag+"</strong></p>";
                content += "<p>è½¦å·:<strong style='color:red;'>"+fleetList[i].number+"</strong>&nbsp;å§‹åˆ›:<strong style='color:red;'>";
                content += (new Date(1000*fleetList[i].created_at)).toLocaleDateString() +"</strong>";
                let radioObj = sessionStorage.getItem("motorcadeStatus");
                if(radioObj=="no_limit"||radioObj==null){
                  content +="&nbsp;é™åˆ¶:<strong style='color:red;'>æ— </strong></p>";
                }else if(radioObj=="level_limit"){
                  content +="&nbsp;é™åˆ¶:<strong style='color:red;'>Lv."+ fleetList[i].applyJoinOption.level +"</strong></p>";
                }else if(radioObj=="noble_limit"){
                  let nobleName = fleetList[i].applyJoinOption.desc;
                  nobleName = nobleName.substring(nobleName.length-2);
                  content +="&nbsp;é™åˆ¶:<strong style='color:red;'>"+ nobleName +"</strong></p>";
                }else if(radioObj == "fans_limit"){
                    content += "<p>ç²‰ä¸ç‰Œ:";
                    let fansList = fleetList[i].applyJoinOption.fansBadgeList;
                    if(fansList!=undefined && fansList.length>0){
                       for(let i=0;i<fansList.length;i++){
                            content +="<a href='https://www.douyu.com/"+fansList[i].rid+"' style='color:darkgreen;font-weight:bold' target='_blank' alt='ç‚¹å‡»è¿›å…¥è¯¥ç²‰ä¸ç›´æ’­é—´'>"+fansList[i].bName+"[Lv."+fansList[i].bLevel+"]&nbsp;";
                       } 
                    }
                    content+= "</p>";

                }
                div.append(content);
                boxes.push(div);
            }
            count++;
            // console.info(boxes);
            return boxes;
        }else{
            $('#loading').text('åŠ è½½å®Œæ¯•ï¼Œæ­¤é¡µè½¦é˜Ÿæ€»æ•°:'+fleetList.length);
        }
        return undefined;
    }
	$(document).ready(function () {
      //scroll event
      $(window).scroll(function () {
        if(($(window).scrollTop() + $(window).height()) >= $(document).height()-50){//&& makeboxes()!=undefined
          $("#device").gridalicious('append', makeboxes());
        }
      });         
	   //maintain
      $("#device").gridalicious({
          gutter: 20,//ç¼éš™å®½åº¦
          width: 300,//å›¾ç‰‡å®½åº¦
          animate: true,//å¯ç”¨åŠ¨ç”»
          animationOptions: {
              speed: 100,
              duration: 400,
              queue: false,//åŒæ­¥æ˜¾ç¤º
              complete:function(data){
                // console.info(data);
              }
          },
      });
    });
</script>
</body>
</html>